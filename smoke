# smoke.py
from google.auth import default
from googleapiclient.discovery import build

SCOPES = ["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/spreadsheets"]

def main():
    creds, _ = default(scopes=SCOPES)
    # Stampa identit√† account e lista 1 file su Drive (per verificare accesso)
    iam = build("iam", "v1", credentials=creds)
    # Se non hai permessi IAM, saltiamo e usiamo Drive come check
    drive = build("drive", "v3", credentials=creds)
    files = drive.files().list(pageSize=1, fields="files(id,name)").execute().get("files", [])
    print("Drive OK; esempio file visibile:", files[0] if files else "nessun file visibile")

if __name__ == "__main__":
    main()
